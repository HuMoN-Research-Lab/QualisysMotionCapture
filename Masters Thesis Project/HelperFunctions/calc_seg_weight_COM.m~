function [total_body_COMXYZ] = calc_seg_weight_COM(seg_center,seg_prop_weight)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% prop_weight was multiplied by each frame of its corresponding marker
% Contributes to calculating total COM of subject
%Prepared based on Miller & Nelson and Lea & Febiger
%Pages 63-64 in David A. Winters book
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Head Seg
head_COM =        seg_prop_weight.head_prop .* seg_center.headCenter_mar_dim_frame;

%% Shoulder Seg
LShoulderCOM =   seg_prop_weight.shoulder_prop .* seg_center.LShoulderCenter_mar_dim_frame;
RShoulderCOM =   seg_prop_weight.shoulder_prop .* seg_center.RShoulderCenter_mar_dim_frame;

%% Chest Seg
chestCOM =       (seg_prop_weight.chestProp + seg_prop_weight.abdomenProp)...
                    .* seg_center.chestCenter_mar_dim_frame;
                
%% UpperArm Seg
LUpperArmCOM =   seg_prop_weight.upperArmProp .* seg_center.LUpperArmCenter_mar_dim_frame;
RUpperArmCOM =   seg_prop_weight.upperArmProp .* seg_center.RUpperArmCenter_mar_dim_frame;

%% Forearm Seg
LForearmCOM =    seg_prop_weight.forearmProp .* seg_center.LForearmCenter_mar_dim_frame;
RForearmCOM =    seg_prop_weight.forearmProp .* seg_center.RForearmCenter_mar_dim_frame;

%% Hand Seg
LHandCOM =       seg_prop_weight.handProp .* seg_center.LHandCenter_mar_dim_frame;
RHandCOM =       seg_prop_weight.handProp .* seg_center.RHandCenter_mar_dim_frame;

%% Hip Seg
hipCOM =         seg_prop_weight.hipProp .* seg_center.hipCenter_mar_dim_frame;

%% Thigh Seg
LThighCOM =      seg_prop_weight.thighProp .* seg_center.LThighCenter_mar_dim_frame;
RThighCOM =      seg_prop_weight.thighProp .* seg_center.RThighCenter_mar_dim_frame;

% LThighCOM =      bodySegMass.thighMass .* segCenter.LThighCenter_mar_dim_frame;
% RThighCOM =      bodySegMass.thighMass .* segCenter.RThighCenter_mar_dim_frame;

%% Leg Seg
LLegCOM =        seg_prop_weight.legProp .* seg_center.LLegCenter_mar_dim_frame;
RLegCOM =        seg_prop_weight.legProp .* seg_center.RLegCenter_mar_dim_frame;

% LLegCOM =        bodySegMass.legMass .* segCenter.LLegCenter_mar_dim_frame;
% RLegCOM =        bodySegMass.legMass .* segCenter.RLegCenter_mar_dim_frame;

%% Foot Seg
LFootCOM =       seg_prop_weight.footProp .* seg_center.LFootCenter_mar_dim_frame;
RFootCOM =       seg_prop_weight.footProp .* seg_center.RFootCenter_mar_dim_frame;

% LFootCOM =       bodySegMass.footMass .* segCenter.LFootCenter_mar_dim_frame;
% RFootCOM =       bodySegMass.footMass .* segCenter.RFootCenter_mar_dim_frame;

%% Total Center_mar_dim_frame for Body
total_body_COMXYZ = (head_COM + LShoulderCOM + RShoulderCOM...
                + chestCOM + LUpperArmCOM + RUpperArmCOM...
                + LForearmCOM + RForearmCOM + LHandCOM ...
                + RHandCOM + hipCOM + LThighCOM + RThighCOM...
                + LLegCOM + RLegCOM + LFootCOM + RFootCOM);

end


